import 'package:booklink_visual/screen/booking/booking.dart';
import 'package:booklink_visual/screen/business/business_screen.dart';
import 'package:booklink_visual/screen/cubit/business_cubit.dart';
import 'package:booklink_visual/screen/cubit/navigator_cubit.dart';
import 'package:booklink_visual/screen/cubit/snackbar_cubit.dart';
import 'package:booklink_visual/screen/cubit/token_cubit.dart';
import 'package:booklink_visual/screen/cubit/user_cubit.dart';
import 'package:booklink_visual/screen/landing/landing.dart';
import 'package:booklink_visual/screen/loading/loading.dart';
import 'package:booklink_visual/screen/private/home_screen.dart';
import 'package:booklink_visual/screen/registration/login.dart';
import 'package:booklink_visual/screen/registration/register.dart';
import 'package:booklink_visual/utils/routes.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:openapi_generator_annotations/openapi_generator_annotations.dart';

void main() {
  runApp(const BooklinkApp());
}

@Openapi(
    additionalProperties: AdditionalProperties(pubName: 'booklink_api', pubAuthor: 'davidfesteban'),
    inputSpecFile: 'booklink_open_api.json',
    generatorName: Generator.dart,
    outputDirectory: 'lib/autogenerated-api')
class BooklinkApp extends StatelessWidget {
  const BooklinkApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MultiBlocProvider(
        providers: [
          BlocProvider(lazy: false, create: (BuildContext context) => TokenCubit()),
          BlocProvider(lazy: false, create: (BuildContext context) => UserCubit()),
          BlocProvider(lazy: false, create: (BuildContext context) => SnackbarCubit()),
          BlocProvider(lazy: false, create: (BuildContext context) => NavigatorCubit()),
          BlocProvider(lazy: false, create: (BuildContext context) => BusinessCubit())
        ],
        child: Builder(builder: ((context) {
          return MaterialApp(
              title: 'Booklink',
              debugShowCheckedModeBanner: false,
              //TODO: What if remove primaryColors?
              theme: ThemeData(primaryColor: Colors.black, useMaterial3: true),
              initialRoute: landing_route,
              scaffoldMessengerKey: context.read<SnackbarCubit>().get(),
              navigatorKey: context.read<NavigatorCubit>().get(),
              routes: {
                landing_route: (context) => const LandingScreen(),
                login_route: (context) => const LoginScreen(),
                join_route: (context) => const JoinPage(),
                loading_route: (context) => LoadingScreen(),
                booking_route: (context) => const BookingScreen(),
                home_route: (context) => const HomeScreen(),
                business_route: (context) => const BusinessScreen(),
                //welcome_route: (context) => WelcomeScreen(),
                //success_route: (context) => SuccessScreen(),
                //error_route: (context) => ErrorScreen()
              });
        })));
  }
}
